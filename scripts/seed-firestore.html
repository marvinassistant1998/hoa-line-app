<!DOCTYPE html>
<html>
<head>
  <title>Firestore åˆå§‹åŒ–è³‡æ–™</title>
  <style>
    body { font-family: -apple-system, sans-serif; max-width: 600px; margin: 50px auto; padding: 20px; }
    button { background: #06C755; color: white; border: none; padding: 12px 24px; border-radius: 8px; font-size: 16px; cursor: pointer; }
    button:disabled { background: #ccc; }
    #log { background: #1D1D1F; color: #34C759; padding: 16px; border-radius: 8px; font-family: monospace; font-size: 13px; white-space: pre-wrap; max-height: 400px; overflow-y: auto; margin-top: 16px; }
  </style>
</head>
<body>
  <h1>ğŸ”¥ Firestore åˆå§‹åŒ–è³‡æ–™</h1>
  <p>é»æ“ŠæŒ‰éˆ•å°‡ mock è³‡æ–™å¯«å…¥ä½ çš„ Firestore è³‡æ–™åº«</p>
  <button id="seedBtn">é–‹å§‹å¯«å…¥è³‡æ–™</button>
  <div id="log"></div>

  <!-- Firebase compat SDK (ä¸éœ€è¦ moduleï¼Œç›´æ¥ç”¨å…¨åŸŸè®Šæ•¸) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

  <script>
    var firebaseConfig = {
      apiKey: "AIzaSyBWm5rKT3535klcNVtWCK6oosdr2BO-ZrQ",
      authDomain: "hoa-line-app-3e2f1.firebaseapp.com",
      projectId: "hoa-line-app-3e2f1",
      storageBucket: "hoa-line-app-3e2f1.firebasestorage.app",
      messagingSenderId: "225045051582",
      appId: "1:225045051582:web:9235d2cddff542456786ef",
    };

    firebase.initializeApp(firebaseConfig);
    var db = firebase.firestore();

    function log(msg) {
      document.getElementById('log').textContent += msg + '\n';
    }

    var residents = [
      { unit: '3F-1', name: 'ç‹å¤§æ˜', phone: '0912-345-678', lineId: 'wang.daming', role: 'ä¸»å§”', moveInDate: '2019-03-15', paymentHistory: [
        { year: 2024, month: 1, paid: true, amount: 2000, paidDate: '2024-01-05' },
        { year: 2024, month: 2, paid: true, amount: 2000, paidDate: '2024-02-03' },
        { year: 2024, month: 3, paid: true, amount: 2000, paidDate: '2024-03-08' },
        { year: 2024, month: 4, paid: false, amount: 2000, paidDate: null },
        { year: 2024, month: 5, paid: false, amount: 2000, paidDate: null },
      ]},
      { unit: '5F-2', name: 'æå°è¯', phone: '0923-456-789', lineId: 'lee.xiaohua', role: 'è²¡å§”', moveInDate: '2020-06-01', paymentHistory: [
        { year: 2024, month: 1, paid: true, amount: 2000, paidDate: '2024-01-10' },
        { year: 2024, month: 2, paid: true, amount: 2000, paidDate: '2024-02-12' },
        { year: 2024, month: 3, paid: true, amount: 2000, paidDate: '2024-03-05' },
        { year: 2024, month: 4, paid: true, amount: 2000, paidDate: '2024-04-08' },
        { year: 2024, month: 5, paid: true, amount: 2000, paidDate: '2024-05-02' },
      ]},
      { unit: '2F-1', name: 'å¼µç¾ç²', phone: '0934-567-890', lineId: 'zhang.meiling', role: 'ä½æˆ¶', moveInDate: '2021-01-20', paymentHistory: [
        { year: 2024, month: 1, paid: true, amount: 2000, paidDate: '2024-01-15' },
        { year: 2024, month: 2, paid: false, amount: 2000, paidDate: null },
        { year: 2024, month: 3, paid: false, amount: 2000, paidDate: null },
        { year: 2024, month: 4, paid: false, amount: 2000, paidDate: null },
        { year: 2024, month: 5, paid: false, amount: 2000, paidDate: null },
      ]},
      { unit: '7F-1', name: 'é™³å»ºå®', phone: '0945-678-901', lineId: 'chen.jianhong', role: 'ç›£å§”', moveInDate: '2018-09-10', paymentHistory: [
        { year: 2024, month: 1, paid: true, amount: 2000, paidDate: '2024-01-03' },
        { year: 2024, month: 2, paid: true, amount: 2000, paidDate: '2024-02-01' },
        { year: 2024, month: 3, paid: true, amount: 2000, paidDate: '2024-03-02' },
        { year: 2024, month: 4, paid: true, amount: 2000, paidDate: '2024-04-05' },
        { year: 2024, month: 5, paid: true, amount: 2000, paidDate: '2024-05-01' },
      ]},
      { unit: '4F-2', name: 'æ—å¿—ç²', phone: '0956-789-012', lineId: 'lin.zhiling', role: 'ä½æˆ¶', moveInDate: '2022-04-01', paymentHistory: [
        { year: 2024, month: 1, paid: true, amount: 2000, paidDate: '2024-01-20' },
        { year: 2024, month: 2, paid: true, amount: 2000, paidDate: '2024-02-18' },
        { year: 2024, month: 3, paid: true, amount: 2000, paidDate: '2024-03-22' },
        { year: 2024, month: 4, paid: false, amount: 2000, paidDate: null },
        { year: 2024, month: 5, paid: false, amount: 2000, paidDate: null },
      ]},
    ];

    var vendors = [
      { name: 'æ°¸ä¿¡é›»æ¢¯', category: 'é›»æ¢¯ç¶­è­·', contact: 'é™³ç¶“ç†', phone: '02-2345-6789', lineId: 'yongxin.elevator', contractStart: '2023-01-01', contractEnd: '2025-12-31', rating: 4.5, notes: 'æ¯æœˆå®šæœŸä¿é¤Šï¼Œåæ‡‰å¿«é€Ÿ', invoices: [
        { id: 'INV001', date: '2024-03-15', amount: 5000, description: '3æœˆä¿é¤Š', image: null },
        { id: 'INV002', date: '2024-04-15', amount: 5000, description: '4æœˆä¿é¤Š', image: null },
      ], serviceRecords: [
        { date: '2024-04-20', type: 'ç·Šæ€¥ç¶­ä¿®', workers: 2, duration: '2å°æ™‚', description: 'é›»æ¢¯ç•°éŸ³è™•ç†', photos: [] },
        { date: '2024-03-15', type: 'å®šæœŸä¿é¤Š', workers: 1, duration: '1å°æ™‚', description: 'ä¾‹è¡Œä¿é¤Š', photos: [] },
      ]},
      { name: 'å¤§å®‰æ¸…æ½”', category: 'æ¸…æ½”æœå‹™', contact: 'æ—å°å§', phone: '02-3456-7890', lineId: 'daan.clean', contractStart: '2024-01-01', contractEnd: '2024-12-31', rating: 4.0, notes: 'æ¯é€±äºŒã€äº”æ‰“æƒå…¬å…±å€åŸŸ', invoices: [
        { id: 'INV003', date: '2024-04-30', amount: 8000, description: '4æœˆæ¸…æ½”è²»', image: null },
      ], serviceRecords: [
        { date: '2024-05-03', type: 'ä¾‹è¡Œæ¸…æ½”', workers: 2, duration: '3å°æ™‚', description: 'å…¬å…±å€åŸŸæ¸…æ½”', photos: [] },
      ]},
      { name: 'å°åŒ—æ°´é›»è¡Œ', category: 'æ°´é›»ç¶­ä¿®', contact: 'å¼µå¸«å‚…', phone: '0922-333-444', lineId: 'taipei.plumber', contractStart: null, contractEnd: null, rating: 4.8, notes: 'å«ä¿®åˆ¶ï¼Œæ”¶è²»åˆç†', invoices: [], serviceRecords: [
        { date: '2024-04-10', type: 'ç¶­ä¿®', workers: 1, duration: '1.5å°æ™‚', description: 'åœ°ä¸‹å®¤æ°´ç®¡æ¼æ°´ä¿®ç¹•', photos: [] },
      ]},
    ];

    var repairs = [
      { title: 'é›»æ¢¯ç•°éŸ³', description: 'é›»æ¢¯é‹è¡Œæ™‚æœ‰ç•°å¸¸è²éŸ³', reportedBy: 'ç‹å¤§æ˜', reportedDate: '2024-05-01', status: 'completed', priority: 'high', assignedVendor: 'æ°¸ä¿¡é›»æ¢¯', completedDate: '2024-05-03', cost: 3500, photos: [] },
      { title: 'åœ°ä¸‹å®¤æ¼æ°´', description: 'B1åœè»Šå ´å¤©èŠ±æ¿æ»²æ°´', reportedBy: 'æå°è¯', reportedDate: '2024-05-05', status: 'in_progress', priority: 'high', assignedVendor: 'å°åŒ—æ°´é›»è¡Œ', completedDate: null, cost: null, photos: [] },
      { title: 'å¤§å»³ç‡ˆæ³¡æ›´æ›', description: 'å¤§å»³æœ‰å…©ç›ç‡ˆä¸äº®', reportedBy: 'å¼µç¾ç²', reportedDate: '2024-05-08', status: 'pending', priority: 'low', assignedVendor: null, completedDate: null, cost: null, photos: [] },
    ];

    var meetings = [
      { title: 'ç¬¬ä¸‰å±†ç¬¬äº”æ¬¡ç®¡å§”æœƒ', date: '2024-05-01', time: '19:30', duration: '1:45:00', location: 'ç¤¾å€æœƒè­°å®¤', attendees: ['ç‹å¤§æ˜','æå°è¯','é™³å»ºå®'], absentees: ['å¼µç¾ç²'], hasAudio: true, hasTranscript: true, summary: 'æœ¬æ¬¡æœƒè­°è¨è«–é›»æ¢¯ç¶­ä¿®ã€æ¸…æ½”åˆç´„çºŒç´„åŠç®¡ç†è²»èª¿æ•´ä¸‰é …è­°é¡Œã€‚', resolutions: ['é€šéé›»æ¢¯ç¶­ä¿®æ¡ˆï¼Œé ç®—ä¸‰è¬äº”åƒå…ƒ','æ¸…æ½”åˆç´„çºŒç´„ä¸€å¹´ï¼Œè²»ç”¨ç¶­æŒä¸è®Š','ç®¡ç†è²»èª¿æ•´æ¡ˆä¿ç•™è‡³å€æ¬Šæœƒè¨è«–'] },
      { title: 'ç¬¬ä¸‰å±†ç¬¬å››æ¬¡ç®¡å§”æœƒ', date: '2024-04-03', time: '19:30', duration: '1:20:00', location: 'ç¤¾å€æœƒè­°å®¤', attendees: ['ç‹å¤§æ˜','æå°è¯','é™³å»ºå®','å¼µç¾ç²'], absentees: [], hasAudio: true, hasTranscript: true, summary: 'è¨è«–æ˜¥ç¯€ç¤¾å€ä½ˆç½®ã€å…¬å…±å€åŸŸæ¶ˆæ¯’ç­‰äº‹é …ã€‚', resolutions: ['æ˜¥ç¯€ä½ˆç½®é ç®—ä¸€è¬å…ƒ','å®‰æ’æœˆåº•å…¨ç¤¾å€æ¶ˆæ¯’'] },
    ];

    document.getElementById('seedBtn').addEventListener('click', async function() {
      var btn = document.getElementById('seedBtn');
      btn.disabled = true;
      btn.textContent = 'å¯«å…¥ä¸­...';
      document.getElementById('log').textContent = '';

      try {
        log('ğŸ”¥ é–‹å§‹å¯«å…¥ Firestore...\n');

        log('ğŸ“‹ å¯«å…¥ä½æˆ¶è³‡æ–™...');
        for (var i = 0; i < residents.length; i++) {
          var r = residents[i];
          var ref = await db.collection('residents').add(Object.assign({}, r, { createdAt: new Date().toISOString() }));
          log('  âœ“ ' + r.name + ' (' + r.unit + ') â†’ ' + ref.id);
        }

        log('\nğŸ¢ å¯«å…¥å» å•†è³‡æ–™...');
        for (var i = 0; i < vendors.length; i++) {
          var v = vendors[i];
          var ref = await db.collection('vendors').add(Object.assign({}, v, { createdAt: new Date().toISOString() }));
          log('  âœ“ ' + v.name + ' â†’ ' + ref.id);
        }

        log('\nğŸ”§ å¯«å…¥ç¶­ä¿®å–®è³‡æ–™...');
        for (var i = 0; i < repairs.length; i++) {
          var rp = repairs[i];
          var ref = await db.collection('repairs').add(Object.assign({}, rp, { createdAt: new Date().toISOString() }));
          log('  âœ“ ' + rp.title + ' â†’ ' + ref.id);
        }

        log('\nğŸ“… å¯«å…¥æœƒè­°è³‡æ–™...');
        for (var i = 0; i < meetings.length; i++) {
          var m = meetings[i];
          var ref = await db.collection('meetings').add(Object.assign({}, m, { createdAt: new Date().toISOString() }));
          log('  âœ“ ' + m.title + ' â†’ ' + ref.id);
        }

        log('\nâœ… å…¨éƒ¨å®Œæˆï¼å…±å¯«å…¥ï¼š');
        log('   ä½æˆ¶ï¼š' + residents.length + ' ç­†');
        log('   å» å•†ï¼š' + vendors.length + ' ç­†');
        log('   ç¶­ä¿®å–®ï¼š' + repairs.length + ' ç­†');
        log('   æœƒè­°ï¼š' + meetings.length + ' ç­†');

        btn.textContent = 'âœ… å¯«å…¥å®Œæˆï¼';
      } catch (error) {
        log('\nâŒ éŒ¯èª¤: ' + error.message);
        btn.textContent = 'é‡è©¦';
        btn.disabled = false;
      }
    });
  </script>
</body>
</html>
